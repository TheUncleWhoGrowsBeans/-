<!--
 * @Author              : Uncle Bean
 * @Date                : 2020-04-27 11:16:19
 * @LastEditors         : Uncle Bean
 * @LastEditTime        : 2020-05-09 17:47:42
 * @FilePath            : \DW\数据治理\数据标准\技术标准\建模规范.md
 * @Description         : 
 -->

# 概述

* 以业务过程为基本单元进行建模
* 遵守数据仓库总线架构，建立一致性维度
* 电商企业数据仓库总线矩阵
    |业务过程|日期|客户|产品|供应商|仓库|
    |:-|:-|:-|:-|:-|:-|:-|
    |商品曝光|Y||||
    |用户浏览|Y||||
    |用户加购|Y||||
    |用户收藏|Y||||
    |用户下单|Y||||
    |用户购买|Y||||
    |商品采购|Y||||
    |商品库存|Y||||
    |商品发货|Y||||
    |用户签收|Y||||
    |用户咨询|Y||||
    |用户投诉|Y||||
    |用户退货|Y||||
    |用户注册|Y||||

* 电商价值链

    * 采购 -> 入库 -> 库存 -> 售卖
    * 曝光 -> 浏览 -> 加购 -> 下单 -> 购买 -> 发货  -> 收货

# 难点

* 一致性维度

# 维度表

* 反规范化：维度表不一定要满足第3范式，通常会冗余不同属性层次描述信息，以便下游使用（具体权衡由存储压力，计算性能以及简单访问性所决定）

# 事实表

* 度量一致命名：不同事实表定义一致的事实必须具有相同的命名

* 度量一致粒度：度量尽量统一细节级别，避免无意义的重复累加（如“日期键，部门键，产品键，产品销量，部门总计销量”中的“部门总计销量”应该去除）

* 度量一致单位：统一度量的单位（某些情况下可参考多种货币事实的处理方法，既保留事务真实单位的事实，也包含统一单位的事实；或者参考多种度量事实的处理方法，只保留公认标准度量单位的事实，同时存储转换到其他度量单位的转换系数）

* 不可加事实拆分：尽可能拆分不可加事实为可加或者半可加事实

* 反规范化：退化常用维度属性到事实表，提高下游使用效率

* 可回溯：

* 事务事实表：尽可能细的粒度，以应对不可预期以及多变的业务需求；原子数据具有最大灵活性，可以任何可能的方式进行汇总

# 其他

* 以空间换时间：目前的分布式计算框架下，存储成本相比于计算成本要小得多

* 操作型代码解码：将代码替换为（或者同时包含）文本属性，减少代码转换依赖，提高可理解性，从而提高效率

* 操作型代码拆解：有时操作码中会包含一些内嵌含义（比如操作码前两位代表xx业务主题、3-4位代表xx业务子类等），此种情况，可将隐含的含义拆分，生成不同的维度属性

* NULL值处理：NULL值会引发一些不可预估的错误。如NULL会导致SQL过滤条件失效，违反参照完整性等。NULL可以转换成0、-1或者Unknown等