<!--
 * @Author              : Uncle Bean
 * @Date                : 2020-05-19 14:05:02
 * @LastEditors         : Uncle Bean
 * @LastEditTime        : 2020-05-21 09:31:23
 * @FilePath            : \DW\数仓建模\模型设计\供应链域\采购.md
 * @Description         : 
--> 

# 采购需求事务事实表

## 概述

采购事务的第一种事务往往是采购需求的发起，涉及需求类型、需求产品、需求数量等。

## 声明粒度

声明粒度为采购需求单的每种商品为一行

## 确定维度

* 采购需求是什么时候发起的：采购需求日期维度
* 发起这个采购需求的驱动类型：采购需求类型维度
* 谁发起的：采购需求发起人员维度
* 需要采购什么：商品维度
* 从哪里采购：供应商维度
* 需求批次：采购需求批次维度

## 确定事实

* 采购多少商品：采购需求数量
* 采购所需金额：采购需求金额

## 逻辑模型

|列名称|列类型|列备注|对应维度表|
|:-|:-|:-|:-|
|采购需求日期|维度外键|格式为YYYYMMDD|日期维度表|
|采购需求类型|退化维|||
|采购需求发起人员键|维度外键||雇员维表|
|商品键|维度外键||商品维度|
|供应商键|维度外键||供应商维度表|
|采购需求编号|退化维|||
|采购需求数量|事实||
|采购需求金额|事实||

# 采购订单事务事实表

## 概述

采购事务的第二种事务往往是采购订单的生成，涉及采购需求相关信息，及实际采购相关信息。

## 声明粒度

声明粒度为采购订单的每种商品为一行。

## 确定维度

* 采购订单是什么时候生成的：采购订单日期维度
* 采购需求是什么时候发起的：采购需求日期维度
* 发起这个采购需求的驱动类型：采购需求类型维度
* 谁发起的：采购需求发起人员维度
* 谁采购的：采购人员维度
* 需要采购什么：商品维度
* 从哪里采购：供应商维度
* 谁负责运送：物流公司维度
* 运费付款方式：运费付款方式维度
* 运送到哪里：仓库维度
* 需求批次：采购需求批次维度
* 采购批次：采购订单批次维度

## 确定事实

* 采购需求多少商品：采购需求数量
* 采购需求所需金额：采购需求金额
* 实际采购多少商品：实际采购数量
* 实际采购所需金额：实际采购金额
* 运费实际是多少钱：运费

## 逻辑模型

|列名称|列类型|列备注|对应维度表|
|:-|:-|:-|:-|
|采购订单日期|维度外键|格式为YYYYMMDD|日期维度表|
|采购需求日期|维度外键|格式为YYYYMMDD|日期维度表|
|采购需求类型|退化维|||
|采购需求发起人员键|维度外键||雇员维表|
|采购人员键|维度外键||雇员维表|
|商品键|维度外键||商品维度|
|供应商键|维度外键||供应商维度包|
|物流公司键|维度外键||物流公司维度表|
|运费付款方式|退化维|||
|仓库键|维度外键||仓库维度表|
|采购需求编号|退化维|||
|采购订单编号|退化维|||
|采购需求数量|事实||
|采购需求金额|事实||
|实际采购数量|事实||
|实际采购金额|事实||
|运费|事实||

# 采购到货事务事实表

## 概述

采购事务的第三种事务往往是采购的到货。

## 声明粒度

声明粒度为到货的采购订单的每种商品为一行。

## 确定维度

* 什么时候到货的：到货日期维度
* 什么时候采购的：采购订单日期维度
* 谁采购的：采购人员维度
* 谁接收到货的：仓库人员维度
* 到货的是什么：商品维度
* 从哪里采购的：供应商维度
* 谁负责运送的：物流公司维度
* 运费付款方式：运费付款方式维度
* 运送到哪里：仓库维度
* 采购批次：采购订单批次维度
* 到货批次：到货批次维度

## 确定事实

* 实际采购多少商品: 实际采购数量
* 实际到货多少商品: 实际到货数量
* 实际验收多少商品: 实际验收数量

## 逻辑模型

|列名称|列类型|列备注|对应维度表|
|:-|:-|:-|:-|
|到货日期|维度外键|格式为YYYYMMDD|日期维度表|
|采购订单日期|维度外键|格式为YYYYMMDD|日期维度表|
|采购人员键|维度外键||雇员维表|
|到货接收人员键|维度外键||雇员维表|
|商品键|维度外键||商品维度|
|供应商键|维度外键||供应商维度包|
|物流公司键|维度外键||物流公司维度表|
|运费付款方式|退化维|||
|仓库键|维度外键||仓库维度表|
|采购订单编号|退化维|||
|到货批次编号|退化维|||
|实际采购数量|事实||
|实际到货数量|事实||
|实际验收数量|事实||

# 其他采购事务

如采购发货、采购退货、采购结算等

# 采购流水线累积快照表

## 概述

采购事务表外的辅助采购快照，监督商品在采购流水线中的运动情况，定义各阶段里程碑。

## 声明粒度

声明粒度为采购流水线中每个批次每种商品为一行。

## 确定维度

* 采购需求是什么时候发起的：采购需求日期维度
* 采购订单是什么时候生成的：采购订单日期维度
* 什么时候到货的：到货日期维度
* 发起这个采购需求的驱动类型：采购需求类型维度
* 谁发起的采购需求：采购需求发起人员维度
* 谁采购的：采购人员维度
* 谁接收到货的：仓库人员维度
* 采购的什么：商品维度
* 从哪里采购：供应商维度
* 谁负责运送的：物流公司维度
* 运送到哪里：仓库维度
* 需求批次：采购需求批次维度
* 采购批次：采购订单批次维度
* 到货批次：到货批次维度

## 确定事实

* 采购需求多少商品：采购需求数量
* 采购需求所需金额：采购需求金额
* 实际采购多少商品：实际采购数量
* 实际采购所需金额：实际采购金额
* 运费实际是多少钱：运费
* 实际到货多少商品: 实际到货数量
* 实际验收多少商品: 实际验收数量
* 从采购需求发起到订单生成花了多少时间：采购需求至下单花费时间
* 从采购订单发起到实际到货花了多少时间：采购下单至到货花费时间

## 逻辑模型

|列名称|列类型|列备注|对应维度表|
|:-|:-|:-|:-|
|采购需求日期|维度外键|格式为YYYYMMDD|日期维度表|
|采购订单日期|维度外键|格式为YYYYMMDD|日期维度表|
|到货日期|维度外键|格式为YYYYMMDD|日期维度表|
|采购需求类型|退化维|||
|采购需求发起人员键|维度外键||雇员维表|
|采购人员键|维度外键||雇员维表|
|到货接收人员键|维度外键||雇员维表|
|商品键|维度外键||商品维度|
|供应商键|维度外键||供应商维度表|
|物流公司键|维度外键||物流公司维度表|
|仓库键|维度外键||仓库维度表|
|采购需求编号|退化维|||
|采购订单编号|退化维|||
|到货批次编号|退化维|||
|采购需求数量|事实||
|采购需求金额|事实||
|实际采购数量|事实||
|实际采购金额|事实||
|运费|事实||
|实际到货数量|事实||
|实际验收数量|事实||
|采购需求至下单花费时间|事实||
|采购下单至到货花费时间|事实||